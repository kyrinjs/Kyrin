# Kyrin Framework

<p align="center">
  <strong>âš¡ High-Performance Minimal Web Framework for Bun</strong>
</p>

<p align="center">
  Fast â€¢ Minimal â€¢ TypeScript-First â€¢ Zero Config
</p>

---

## ğŸš€ Quick Start

```typescript
import { Kyrin } from "kyrin";

const app = new Kyrin();

app.get("/", () => ({ message: "Hello Kyrin!" }));

app.listen(3000);
```

```bash
bun run src/index.ts
# ğŸš€ Kyrin running at http://localhost:3000
```

---

## ğŸ“¦ Installation

```bash
bun add kyrin
```

---

## ğŸ“– Table of Contents

1. [Basic Routing](#-basic-routing)
2. [Route Parameters](#-route-parameters)
3. [Query Parameters](#-query-parameters)
4. [Request Body](#-request-body)
5. [Response Helpers](#-response-helpers)
6. [Auto Response](#-auto-response)
7. [Headers](#-headers)
8. [Redirects](#-redirects)
9. [Configuration](#ï¸-configuration)
10. [API Reference](#-api-reference)

---

## ğŸ›£ï¸ Basic Routing

Kyrin supports all standard HTTP methods:

```typescript
const app = new Kyrin();

app.get("/users", (c) => c.json({ users: [] }));
app.post("/users", (c) => c.json({ created: true }, 201));
app.put("/users/:id", (c) => c.json({ updated: true }));
app.delete("/users/:id", (c) => c.json({ deleted: true }));
app.patch("/users/:id", (c) => c.json({ patched: true }));

// Register all methods at once
app.all("/health", (c) => c.text("OK"));

// Custom method
app.on("CUSTOM", "/endpoint", (c) => c.text("Custom!"));
```

### Method Chaining

All routing methods return `this` for fluent chaining:

```typescript
app
  .get("/", () => "Home")
  .get("/about", () => "About")
  .post("/contact", () => ({ sent: true }))
  .listen(3000);
```

---

## ğŸ¯ Route Parameters

Define dynamic route segments with `:paramName`:

```typescript
// Single parameter
app.get("/users/:id", (c) => {
  const id = c.param("id");
  return { id };
});

// Multiple parameters
app.get("/users/:userId/posts/:postId", (c) => ({
  userId: c.param("userId"),
  postId: c.param("postId"),
}));

// Wildcard (catch-all)
app.get("/files/*", (c) => {
  const path = c.param("wildcard"); // everything after /files/
  return { path };
});
```

---

## ğŸ” Query Parameters

Access URL query parameters with `c.query()`:

```typescript
// GET /search?q=hello&page=2
app.get("/search", (c) => {
  const query = c.query("q"); // "hello"
  const page = c.query("page"); // "2"
  const limit = c.query("limit"); // null (not provided)

  return { query, page, limit };
});
```

---

## ğŸ“¥ Request Body

### JSON Body

```typescript
// Define interface for type safety
interface CreateUser {
  name: string;
  email: string;
}

app.post("/users", async (c) => {
  const body = await c.body<CreateUser>();

  console.log(body.name); // TypeScript knows it's string
  console.log(body.email);

  return c.json({ created: body.name }, 201);
});
```

### Text Body

```typescript
app.post("/webhook", async (c) => {
  const rawBody = await c.bodyText();
  console.log(rawBody); // raw string

  return { received: true };
});
```

---

## ğŸ“¤ Response Helpers

### JSON Response

```typescript
app.get("/api/data", (c) => {
  return c.json({ status: "ok" }); // 200 OK
  return c.json({ created: true }, 201); // 201 Created
  return c.json({ error: "Bad" }, 400); // 400 Bad Request
});
```

### Text Response

```typescript
app.get("/plain", (c) => {
  return c.text("Hello World"); // 200 OK
  return c.text("Created!", 201); // 201 Created
});
```

### HTML Response

```typescript
app.get("/page", (c) => {
  return c.html("<h1>Hello</h1>");
  return c.html("<h1>Error</h1>", 500);
});
```

---

## âœ¨ Auto Response

Kyrin automatically detects and converts your return values:

| Return Type        | Response           |
| ------------------ | ------------------ |
| `object` / `array` | `application/json` |
| `string`           | `text/plain`       |
| `null` / `void`    | `204 No Content`   |
| `Response`         | As-is              |

### Examples

```typescript
// Auto JSON - just return an object!
app.get("/users", () => ({ users: [] }));
// â†’ Content-Type: application/json

// Auto Text - just return a string!
app.get("/hello", () => "Hello World!");
// â†’ Content-Type: text/plain

// No Content - return null
app.delete("/users/:id", () => null);
// â†’ 204 No Content

// Explicit Response - still works
app.get("/custom", (c) => c.json({ status: "ok" }));
```

---

## ğŸ“‹ Headers

### Read Request Headers

```typescript
app.get("/protected", (c) => {
  // Single header
  const auth = c.header("Authorization");
  const contentType = c.header("Content-Type");

  // All headers
  const allHeaders = c.headers; // Headers object

  if (!auth) {
    return c.json({ error: "Unauthorized" }, 401);
  }

  return { success: true };
});
```

### Other Request Properties

```typescript
app.get("/info", (c) => ({
  method: c.method, // "GET"
  path: c.path, // "/info"
  req: c.req, // Raw Request object
}));
```

---

## ğŸ”„ Redirects

```typescript
app.get("/old-page", (c) => {
  return c.redirect("/new-page"); // 302 Found (default)
});

app.get("/permanent", (c) => {
  return c.redirect("/new-url", 301); // 301 Permanent
});

app.get("/temp", (c) => {
  return c.redirect("/temp-page", 307); // 307 Temporary
});
```

---

## âš™ï¸ Configuration

```typescript
const app = new Kyrin({
  port: 3000, // Default: 3000
  hostname: "0.0.0.0", // Default: "localhost"
  development: true, // Default: false (enables Bun dev mode)
});

// Override port in listen
app.listen(8080); // Uses 8080 instead of config port
```

---

## ğŸ”§ API Reference

### Kyrin Class

| Method                      | Description            |
| --------------------------- | ---------------------- |
| `get(path, handler)`        | Register GET route     |
| `post(path, handler)`       | Register POST route    |
| `put(path, handler)`        | Register PUT route     |
| `delete(path, handler)`     | Register DELETE route  |
| `patch(path, handler)`      | Register PATCH route   |
| `options(path, handler)`    | Register OPTIONS route |
| `head(path, handler)`       | Register HEAD route    |
| `all(path, handler)`        | Register all methods   |
| `on(method, path, handler)` | Register custom method |
| `listen(port?)`             | Start server           |

### Context (c) Object

#### Request Helpers

| Property/Method  | Type              | Description        |
| ---------------- | ----------------- | ------------------ |
| `c.req`          | `Request`         | Raw request object |
| `c.method`       | `string`          | HTTP method        |
| `c.path`         | `string`          | Request path       |
| `c.headers`      | `Headers`         | All headers        |
| `c.header(name)` | `string \| null`  | Get header         |
| `c.param(name)`  | `string \| null`  | Get path param     |
| `c.query(name)`  | `string \| null`  | Get query param    |
| `c.body<T>()`    | `Promise<T>`      | Parse JSON body    |
| `c.bodyText()`   | `Promise<string>` | Get raw text body  |

#### Response Helpers

| Method                     | Description       |
| -------------------------- | ----------------- |
| `c.json(data, status?)`    | JSON response     |
| `c.text(data, status?)`    | Text response     |
| `c.html(data, status?)`    | HTML response     |
| `c.redirect(url, status?)` | Redirect response |
| `c.notFound()`             | 404 response      |

---

## ğŸ“ Project Structure

```
kyrin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts           # Entry point
â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”œâ”€â”€ index.ts       # Context exports
â”‚   â”‚   â””â”€â”€ context.ts     # Context class
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ kyrin.ts       # Main Kyrin class
â”‚   â”‚   â””â”€â”€ types.ts       # TypeScript types
â”‚   â””â”€â”€ router/
â”‚       â”œâ”€â”€ router.ts      # HTTP Router
â”‚       â””â”€â”€ radix-tree.ts  # Radix tree implementation
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

---

## ğŸƒ Running

```bash
# Development
bun run dev

# Production
bun run src/index.ts
```

---

## ğŸ“„ License

MIT Â© Kyrin Framework

---

<p align="center">
  Made with â¤ï¸ for the Bun ecosystem
</p>
